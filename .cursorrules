# üéØ REGLAS PARA CURSOR - FINANZASMARKETING

## ‚ö†Ô∏è IDENTIFICACI√ìN CR√çTICA DEL PROYECTO

**PROYECTO ACTUAL:** `finanzasmarketing/`
**RUTA COMPLETA:** `C:\Users\bruno\OneDrive\Escritorio\carpeta\finanzasmarketing\`

**‚ö†Ô∏è IMPORTANTE:** Este es un sistema INDEPENDIENTE de `finanzas/`. NO modificar `finanzas/` pensando que afecta a este proyecto.

---

## üìÅ ESTRUCTURA DEL PROYECTO

### Rutas Frontend (apps/web/app/)

```
apps/web/app/
‚îú‚îÄ‚îÄ (marketing)/          # Rutas de marketing p√∫blico
‚îÇ   ‚îî‚îÄ‚îÄ [locale]/        # Rutas con locale (en, de)
‚îÇ       ‚îú‚îÄ‚îÄ (home)/      # P√°gina principal
‚îÇ       ‚îú‚îÄ‚îÄ blog/        # Blog
‚îÇ       ‚îú‚îÄ‚îÄ docs/        # Documentaci√≥n
‚îÇ       ‚îú‚îÄ‚îÄ marketing/   # P√°ginas de marketing
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ (saas)/              # Rutas de aplicaci√≥n SaaS
‚îÇ   ‚îú‚îÄ‚îÄ app/             # Dashboard principal
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (account)/   # Cuenta del usuario
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ finance/ # Dashboard de finanzas
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ chatbot/ # Chat con IA
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ settings/# Configuraci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (organizations)/ # Organizaciones
‚îÇ   ‚îú‚îÄ‚îÄ auth/            # Autenticaci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ api/                 # API Routes
    ‚îú‚îÄ‚îÄ [[...rest]]/     # RPC Handler principal
    ‚îú‚îÄ‚îÄ marketing/       # Endpoints de marketing
    ‚îî‚îÄ‚îÄ cron/            # Cron jobs
```

### Rutas API (packages/api/modules/)

```
packages/api/modules/
‚îú‚îÄ‚îÄ finance/             # ‚úÖ M√≥dulo de finanzas
‚îÇ   ‚îú‚îÄ‚îÄ procedures/      # Endpoints RPC
‚îÇ   ‚îî‚îÄ‚îÄ services/        # L√≥gica de negocio
‚îú‚îÄ‚îÄ marketing/           # ‚úÖ M√≥dulo de marketing (COMPLETO)
‚îÇ   ‚îú‚îÄ‚îÄ procedures/      # Endpoints RPC
‚îÇ   ‚îú‚îÄ‚îÄ services/        # Servicios (Postiz, Publer, etc.)
‚îÇ   ‚îî‚îÄ‚îÄ utils/           # Utilidades
‚îú‚îÄ‚îÄ admin/               # Administraci√≥n
‚îú‚îÄ‚îÄ ai/                  # Chat con IA
‚îú‚îÄ‚îÄ auth/                # Autenticaci√≥n
‚îî‚îÄ‚îÄ ...
```

---

## üîå ENDPOINTS API DISPONIBLES

### RPC Endpoints (oRPC)

**Formato:** `/api/rpc/{module}.{procedure}` o `/api/rpc/{module}.{submodule}.{procedure}`

#### Finance Module
- `finance.getOverview` - GET
- `finance.predictMetrics` - GET
- `finance.detectAnomalies` - GET
- `finance.getCohortAnalysis` - GET
- `finance.calculateUnitEconomics` - GET
- `finance.getBenchmarking` - GET
- `finance.analyzeSaas` - GET
- `finance.executeAction` - POST

#### Marketing Module
- `marketing.analytics.dashboard` - GET
- `marketing.visual.generate` - POST
- `marketing.visual.variants` - POST
- `marketing.content.generate` - POST
- `marketing.social.publish` - POST
- `marketing.social.schedule` - POST
- `marketing.crm.*` - Varios endpoints CRM
- `marketing.email.*` - Varios endpoints de email
- `marketing.strategy.*` - Estrategias de marketing
- `marketing.competitor.*` - An√°lisis de competidores
- `marketing.facebookAds.*` - Facebook Ads
- `marketing.googleAds.*` - Google Ads
- `marketing.launch.*` - Lanzamientos
- `marketing.orchestration.*` - Orquestaci√≥n

#### Otros M√≥dulos
- `admin.*` - Administraci√≥n
- `ai.*` - Chat con IA
- `organizations.*` - Organizaciones
- `payments.*` - Pagos
- `users.*` - Usuarios

### API Routes (Next.js)

- `/api/marketing/content-ready` - GET/POST (contenido listo para publicar)
- `/api/marketing/social-publish` - POST (publicar en redes sociales)
- `/api/cron/social-publish` - GET (cron job para publicaci√≥n autom√°tica)
- `/api/admin/cleanup` - POST (limpieza de datos de prueba)
- `/api/docs-search` - GET (b√∫squeda en documentaci√≥n)
- `/api/autosaas/webhook` - POST (webhook de AutoSaaS)

---

## üõ†Ô∏è SERVICIOS DE MARKETING

### Postiz Service (‚≠ê √öNICO EN FINANZASMARKETING)
- **Archivo:** `packages/api/modules/marketing/services/postiz-service.ts`
- **Prop√≥sito:** Integraci√≥n con Postiz API para publicaci√≥n social
- **M√©todos principales:**
  - `publishToPostiz()` - Publicar contenido
  - `getPostizAccounts()` - Obtener cuentas conectadas
  - `schedulePost()` - Programar publicaci√≥n

### Publer Service
- **Archivo:** `packages/api/modules/marketing/services/publer-service.ts`
- **Prop√≥sito:** Integraci√≥n con Publer API (fallback)
- **Nota:** Postiz es el servicio por defecto

### Otros Servicios
- `content-agent.ts` - Generaci√≥n de contenido con IA
- `content-generator-v2.ts` - Generador avanzado de contenido
- `social-agent.ts` - Agente de redes sociales
- `visual-agent.ts` - Generaci√≥n de im√°genes
- `voice-agent.ts` - Generaci√≥n de audio
- `crm-service.ts` - CRM
- `analytics-service.ts` - Analytics
- `strategy-agent.ts` - Estrategias de marketing

---

## üö´ REGLAS CR√çTICAS

### NO MODIFICAR (a menos que sea expl√≠citamente necesario)

1. **Base de datos compartida:**
   - ‚ö†Ô∏è `packages/database/prisma/schema.prisma` puede estar compartido
   - ‚ö†Ô∏è Verificar antes de modificar el schema
   - ‚ö†Ô∏è Cambios en schema pueden afectar a `finanzas/` si comparten BD

2. **Configuraci√≥n base:**
   - `config/index.ts` - Verificar si cambios afectan a ambos proyectos

### √ÅREAS SEGURAS PARA MODIFICAR

‚úÖ **Todo en `finanzasmarketing/` es seguro modificar:**
- `apps/web/` - Frontend completo
- `packages/api/modules/finance/` - M√≥dulo de finanzas
- `packages/api/modules/marketing/` - M√≥dulo de marketing
- `packages/api/modules/*` - Todos los m√≥dulos API
- Configuraciones espec√≠ficas del proyecto

---

## üîç IDENTIFICACI√ìN DE ARCHIVOS

### C√≥mo saber si est√°s en el proyecto correcto:

1. **Ruta del archivo debe empezar con:**
   ```
   finanzasmarketing/
   ```
   NO `finanzas/`

2. **Verificar en terminal:**
   ```bash
   pwd  # Debe mostrar: .../finanzasmarketing
   ```

3. **Verificar package.json:**
   - Debe estar en `finanzasmarketing/package.json`
   - NO en `finanzas/package.json`

---

## üìù CONVENCIONES DE C√ìDIGO

### Estructura de Procedures (oRPC)

```typescript
// Ejemplo: packages/api/modules/marketing/procedures/content.ts
import { protectedProcedure } from "../../../orpc/procedures";
import { z } from "zod";

export const generateContent = protectedProcedure
  .route({ method: "POST", path: "/marketing/content/generate" })
  .input(z.object({
    // schema de input
  }))
  .output(z.object({
    // schema de output
  }))
  .handler(async ({ input, context }) => {
    // l√≥gica aqu√≠
    return result;
  });
```

### Estructura de Services

```typescript
// Ejemplo: packages/api/modules/marketing/services/postiz-service.ts
export class PostizService {
  async publishToPostiz(data: PublishData): Promise<PostizResponse> {
    // implementaci√≥n
  }
}
```

### Rutas Frontend

```typescript
// Ejemplo: apps/web/app/(saas)/app/(account)/finance/page.tsx
"use client";

export default function FinancePage() {
  // componente
}
```

---

## üéØ CUANDO TRABAJAR EN ESTE PROYECTO

### Usa `finanzasmarketing/` para:

‚úÖ **Marketing:**
- Cualquier feature de marketing
- Integraci√≥n con Postiz
- Publicaci√≥n social
- Generaci√≥n de contenido
- CRM, Analytics, Ads

‚úÖ **Finanzas:**
- Features de finanzas (igual que finanzas/)
- Dashboard financiero
- M√©tricas y an√°lisis

‚úÖ **Despliegues:**
- Producci√≥n (Railway)
- Testing completo del sistema

### NO uses `finanzasmarketing/` para:

‚ùå Desarrollo aislado de finanzas sin marketing
‚ùå Pruebas que no requieren marketing

---

## üîó INTEGRACIONES

### Postiz API
- **Variable de entorno:** `POSTIZ_API_KEY`
- **Service:** `packages/api/modules/marketing/services/postiz-service.ts`
- **Endpoints que usan:** `/api/marketing/social-publish`, `/api/cron/social-publish`

### Publer API (Fallback)
- **Variable de entorno:** `PUBLER_API_KEY`
- **Service:** `packages/api/modules/marketing/services/publer-service.ts`

### Base de Datos
- **Prisma:** `packages/database/prisma/schema.prisma`
- **‚ö†Ô∏è Puede estar compartida con `finanzas/`**

---

## üöÄ COMANDOS √öTILES

```bash
# Desarrollo
pnpm dev

# Build
pnpm build

# Type check
pnpm type-check

# Database
pnpm db:push      # Push schema a BD
pnpm db:generate # Generar Prisma Client

# Linting
pnpm lint
pnpm lint:fix
```

---

## üìö DOCUMENTACI√ìN ADICIONAL

- `ESTRUCTURA-PROYECTOS.md` - Comparaci√≥n completa con `finanzas/`
- `RAILWAY-POSTIZ-SETUP.md` - Configuraci√≥n de Postiz
- `GUIA-PROMPTS-MARKETINGOS.md` - Gu√≠a para trabajar en marketing
- `SUPASTARTER-BLUEPRINT.md` - Arquitectura general

---

**√öltima actualizaci√≥n:** 2025-01-XX  
**Proyecto:** `finanzasmarketing/` (Sistema completo - Finanzas + Marketing)















